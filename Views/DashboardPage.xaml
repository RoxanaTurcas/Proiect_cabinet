<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="Proiect.Views.DashboardPage"
             Title="Panou de Control">


    <Grid RowDefinitions="Auto, *" Padding="20">

        <VerticalStackLayout Grid.Row="0" Spacing="10" Margin="0,0,0,20">
            <Label x:Name="WelcomeLabel" 
                   Text="Bine ai venit!" 
                   FontSize="22" FontAttributes="Bold" />

            <Button Text="Deconectare" 
                    Clicked="OnLogoutClicked" 
                    BackgroundColor="#FFCDD2" 
                    TextColor="Red" 
                    HeightRequest="40" 
                    HorizontalOptions="End" />
        </VerticalStackLayout>

        <ScrollView x:Name="ClientSection" Grid.Row="1" IsVisible="False">
            <VerticalStackLayout Spacing="10" Padding="0,0,0,20">

                <Label Text="Animalele tale:" FontSize="18" TextColor="#512BD4"/>

                <CollectionView x:Name="PetsCollection" HeightRequest="150">
                    <CollectionView.EmptyView>
                        <Label Text="Nu ai adÄƒugat niciun animal." TextColor="Gray"/>
                    </CollectionView.EmptyView>
                    <CollectionView.ItemTemplate>
                        <DataTemplate>
                            <Frame Margin="0,5" Padding="10" BorderColor="Gray">
                                <Grid ColumnDefinitions="*, Auto, Auto, Auto">

                                    <VerticalStackLayout Grid.Column="0" VerticalOptions="Center" Spacing="0">
                                        <Label Text="{Binding Nume}" FontSize="16" FontAttributes="Bold" TextColor="Black"/>

                                        <Label Text="{Binding Specie, StringFormat='Specie: {0}'}" 
                                               TextColor="#512BD4" 
                                               FontSize="12"
                                               FontAttributes="Italic"/>

                                        <Label Text="{Binding Rasa, StringFormat='RasÄƒ: {0}'}" TextColor="Gray" FontSize="11"/>

                                        <Label Text="{Binding Varsta, StringFormat='VÃ¢rstÄƒ: {0} ani'}" TextColor="Gray" FontSize="11"/>
                                    </VerticalStackLayout>

                                    <Button Grid.Column="1" 
                                            Text="ðŸ“„" 
                                            Clicked="OnOpenHealthRecordClicked"
                                            CommandParameter="{Binding .}" 
                                            BackgroundColor="#512BD4"
                                            TextColor="White"
                                            HeightRequest="35" WidthRequest="40" Padding="0" Margin="0,0,5,0"/>

                                    <Button Grid.Column="2" 
                                            Text="âœï¸" 
                                            Clicked="OnEditPetClicked"
                                            CommandParameter="{Binding .}" 
                                            BackgroundColor="Orange"
                                            TextColor="White"
                                            HeightRequest="35" WidthRequest="40" Padding="0" Margin="0,0,5,0"/>

                                    <Button Grid.Column="3" 
                                            Text="ðŸ—‘ï¸" 
                                            Clicked="OnDeletePetClicked"
                                            CommandParameter="{Binding .}" 
                                            BackgroundColor="Red"
                                            TextColor="White"
                                            HeightRequest="35" WidthRequest="40" Padding="0"/>
                                </Grid>
                            </Frame>
                        </DataTemplate>
                    </CollectionView.ItemTemplate>
                </CollectionView>
                <Button Text="+ AdaugÄƒ Animal Nou" Clicked="OnAddPetClicked" BackgroundColor="#512BD4" TextColor="White"/>
                <Button Text="ðŸ“… Programare NouÄƒ" Clicked="OnRequestAppointmentClicked" BackgroundColor="Orange" TextColor="White" Margin="0,10,0,0"/>

                <Label Text="Status ProgramÄƒri:" FontSize="18" TextColor="#512BD4" Margin="0,20,0,0"/>
                <CollectionView x:Name="ClientAppointmentsCollection" HeightRequest="250">
                    <CollectionView.EmptyView>
                        <Label Text="Nu ai nicio programare." TextColor="Gray"/>
                    </CollectionView.EmptyView>
                    <CollectionView.ItemTemplate>
                        <DataTemplate>
                            <Frame Margin="0,5" Padding="10" BorderColor="LightGray">
                                <Grid ColumnDefinitions="*, Auto, Auto">

                                    <VerticalStackLayout Grid.Column="0">
                                        <Label Text="{Binding NumeAnimalDisplay, StringFormat='Animal: {0}'}" FontAttributes="Bold"/>
                                        <Label Text="{Binding Data, StringFormat='{0:dd MMM HH:mm}'}" TextColor="Black"/>
                                        <Label Text="{Binding Scop}" TextColor="Gray" FontSize="12"/>
                                    </VerticalStackLayout>

                                    <Label Grid.Column="1" 
                                           Text="{Binding Status}" 
                                           FontAttributes="Bold" 
                                           TextColor="Blue" 
                                           VerticalOptions="Center"
                                           Margin="5,0"/>

                                    <Button Grid.Column="2"
                                            Text="â­"
                                            Clicked="OnLeaveReviewClicked"
                                            CommandParameter="{Binding .}"
                                            BackgroundColor="Gold"
                                            TextColor="Black"
                                            HeightRequest="40"
                                            WidthRequest="40"
                                            Padding="0"
                                            VerticalOptions="Center"/>
                                </Grid>
                            </Frame>
                        </DataTemplate>
                    </CollectionView.ItemTemplate>
                </CollectionView>

            </VerticalStackLayout>
        </ScrollView>

        <ScrollView x:Name="MedicSection" Grid.Row="1" IsVisible="False">
            <VerticalStackLayout Spacing="10">
                <Label Text="ProgramÄƒrile Viitoare:" FontSize="18" TextColor="#512BD4"/>

                <CollectionView x:Name="AppointmentsCollection" HeightRequest="300">
                    <CollectionView.EmptyView>
                        <Label Text="Nu existÄƒ cereri de programare." TextColor="Gray" HorizontalOptions="Center"/>
                    </CollectionView.EmptyView>
                    <CollectionView.ItemTemplate>
                        <DataTemplate>
                            <Frame Margin="0,5" Padding="10" BorderColor="Blue" BackgroundColor="#F0F8FF">
                                <VerticalStackLayout Spacing="5">

                                    <Grid ColumnDefinitions="*, Auto">
                                        <Label Grid.Column="0" 
                                               Text="{Binding Data, StringFormat='ðŸ“… {0:dd MMM HH:mm}'}" 
                                               FontAttributes="Bold" TextColor="#512BD4"/>
                                        <Label Grid.Column="1" 
                                               Text="{Binding Status}" 
                                               FontAttributes="Bold" TextColor="OrangeRed"/>
                                    </Grid>

                                    <BoxView HeightRequest="1" Color="LightGray" Margin="0,5"/>

                                    <Label Text="{Binding NumeClientDisplay, StringFormat='ðŸ‘¤ Client: {0}'}" 
                                           TextColor="Black" FontAttributes="Bold"/>

                                    <Label Text="{Binding NumeAnimalDisplay, StringFormat='ðŸ¾ Pacient: {0}'}" 
                                           TextColor="Black"/>

                                    <Label Text="{Binding Scop, StringFormat='ðŸ“ Scop: {0}'}" 
                                           TextColor="Gray" FontAttributes="Italic"/>

                                    <HorizontalStackLayout Spacing="10" Margin="0,10,0,0" HorizontalOptions="Center">

                                        <Button Text="ðŸ“˜ Carnet" 
                                                Clicked="OnDoctorOpenHealthRecordClicked"
                                                CommandParameter="{Binding .}" 
                                                BackgroundColor="#512BD4" 
                                                HeightRequest="35" FontSize="12" Padding="10,0"/>

                                        <Button Text="âœ… ConfirmÄƒ" 
                                                Clicked="OnConfirmClicked"
                                                CommandParameter="{Binding .}" 
                                                BackgroundColor="Green" 
                                                HeightRequest="35" FontSize="12" Padding="10,0"/>

                                        <Button Text="âŒ RefuzÄƒ" 
                                                Clicked="OnRejectClicked"
                                                CommandParameter="{Binding .}"
                                                BackgroundColor="Red" 
                                                HeightRequest="35" FontSize="12" Padding="10,0"/>

                                    </HorizontalStackLayout>

                                </VerticalStackLayout>
                            </Frame>
                        </DataTemplate>
                    </CollectionView.ItemTemplate>
                </CollectionView>
                <Label Text="Recenziile tale:" 
                       FontSize="18" 
                       TextColor="#512BD4" 
                       Margin="0,20,0,5"
                       FontAttributes="Bold"/>

                <CollectionView x:Name="ReviewsCollection" HeightRequest="200">
                    <CollectionView.EmptyView>
                        <Label Text="Nu ai nicio recenzie Ã®ncÄƒ." TextColor="Gray"/>
                    </CollectionView.EmptyView>
                    <CollectionView.ItemTemplate>
                        <DataTemplate>
                            <Frame Margin="0,5" Padding="10" BorderColor="Gold" BackgroundColor="#FFFFF0">
                                <VerticalStackLayout>
                                    <Grid ColumnDefinitions="*, Auto">
                                        <Label Grid.Column="0" 
                                               Text="{Binding NumeClientDisplay}" 
                                               FontAttributes="Bold"/>

                                        <Label Grid.Column="1" 
                                               Text="{Binding Nota, StringFormat='{0} â­'}" 
                                               TextColor="OrangeRed" 
                                               FontAttributes="Bold"/>
                                    </Grid>

                                    <Label Text="{Binding Comentariu}" 
                                           TextColor="Black" 
                                           Margin="0,5,0,0" 
                                           FontAttributes="Italic"/>

                                    <Label Text="{Binding DataReview, StringFormat='{0:dd MMM yyyy}'}" 
                                           FontSize="10" 
                                           TextColor="Gray" 
                                           HorizontalOptions="End"/>
                                </VerticalStackLayout>
                            </Frame>
                        </DataTemplate>
                    </CollectionView.ItemTemplate>
                </CollectionView>
            </VerticalStackLayout>
        </ScrollView>

    </Grid>
</ContentPage>